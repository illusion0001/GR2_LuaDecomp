GAME_CLEAR_SCORE = 50
TRAIN_BONUS_NUM = 15
GRABTHROW_RANGE_LIMIT = 20
GRABTHROW_TIME_LIMIT = 4
LINEUP_TOP_WAIT = 1
LINEUP_RETRY = 0.3
BONUS_TRAIN_GROUP_PER_NUM = 5
L0_0 = {}
L0_0.balloon_stay01 = "chi01_cheer_00"
L0_0.balloon_stay02 = "chi01_wavehand_00"
L0_0.balloon_stay03 = "chi01_talk_laugh_00"
L0_0.accor_man_stay01 = "man01_listen_sm46_00"
L0_0.accor_man_stay02 = "man01_handclap_00"
L0_0.accor_man_stay03 = "man01_talk_03"
L0_0.accor_wom_stay01 = "wom01_handclap_00"
L0_0.accor_wom_stay02 = "wom01_watching_00"
L0_0.accor_wom_stay03 = "wom01_listen_00"
L0_0.accor_chi_stay01 = "chi01_listen_00"
L0_0.accor_chi_stay02 = "chi01_handclap_00"
L0_0.accor_chi_stay03 = "chi01_cheer_00"
L0_0.police_stay0 = "man66_stay_00"
L0_0.police_stay1 = "man66_stay_gate_00"
L0_0.police_talk_r = "man66_talk_r_00"
L0_0.police_talk_l = "man66_talk_l_00"
L0_0.stu_talk00 = "man01_talk_laugh_00"
L0_0.stu_talk01 = "man01_talk_laugh_01"
L0_0.stu_talk02 = "man01_talk_laugh_02"
L0_0.stu_talk03 = "man01_talk_laugh_03"
L0_0.stu_wom_talk00 = "wom01_talk_laugh_00"
L0_0.stu_wom_talk01 = "wom01_talk_laugh_01"
L0_0.stu_wom_talk02 = "wom01_talk_laugh_02"
L0_0.stu_wom_talk03 = "wom01_talk_laugh_03"
L0_0.stu_stay = "man01_talk_sad_00"
L0_0.greeting = "man01_greeting_00"
NPC_MOTION = L0_0
L0_0 = {
  "man01_vendor_attract_00",
  "man01_watching_soft_00",
  "man01_talk_laugh_02",
  "man01_talk_laugh_01",
  "man01_talk_laugh_00",
  "man01_talk_04",
  "man01_stretch_00",
  "man01_stay_line_00",
  "man01_lookaround_03"
}
CLIENT_MOTION_TBL = L0_0
L0_0 = {}
_task_dest_manager = L0_0
L0_0 = {}
_mobs = L0_0
L0_0 = {}
_guests = L0_0
L0_0 = {}
_guest_ready = L0_0
L0_0 = {}
_guest_move = L0_0
L0_0 = {}
_guest_goal = L0_0
L0_0 = {}
_guest_finish = L0_0
L0_0 = {}
_guest_lineup_task = L0_0
L0_0 = {}
_guest_lineup_node = L0_0
L0_0 = {}
_guest_grab = L0_0
L0_0 = {}
_guest_release_task = L0_0
L0_0 = {}
_bonus_guest_table = L0_0
L0_0 = {}
_puppets = L0_0
_score = 0
_group_spawn_step = 0
_walk_start_group_max = 0
_goal_maker = nil
L0_0 = {}
_mob_to_npc_table = L0_0
_mob_to_npc_task = nil
L0_0 = {}
_walk_table = L0_0
L0_0 = {}
_clear_lineup_node = L0_0
L0_0 = {}
_bonus_action_name = L0_0
L0_0 = {}
_bonus_action_task = L0_0
RET_MAX = 4
L0_0 = RET_MAX
_line_up_ret_max = L0_0
L0_0 = {
  {
    _mot01 = "man01_lookaround_00",
    _mot02 = "man01_lookaround_01",
    _mot03 = "man01_lookaround_02",
    _mot04 = "man01_stay_01",
    _mot05 = "man01_stay_line_00",
    _mot06 = "man01_stay_line_01",
    _mot07 = "man01_stretch_00"
  },
  {
    _mot01 = "wom01_lookaround_00",
    _mot02 = "wom01_lookaround_01",
    _mot03 = "wom01_stay_01",
    _mot04 = "wom01_stay_03",
    _mot05 = "wom01_stay_line_00",
    _mot06 = "wom01_stay_line_01",
    _mot07 = "wom01_watching_soft_00"
  },
  {
    _mot01 = "chi01_relax_00",
    _mot02 = "chi01_stay_01",
    _mot03 = "chi01_stay_02",
    _mot04 = "chi01_stay_line_00",
    _mot05 = "chi01_stay_line_01",
    _mot06 = "chi01_stay_tired_00",
    _mot07 = "chi01_stretch_00"
  }
}
_line_up_motion = L0_0
L0_0 = {
  {
    name = "sm26_passer_05_01",
    type = "man_hex_dt",
    node = "locator2_passer_04_01",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_02",
    type = "man_hex_dt",
    node = "locator2_passer_04_02",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_03",
    type = "man_hex_dt",
    node = "locator2_passer_04_03",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_04",
    type = "man_hex_dt",
    node = "locator2_passer_04_04",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_05",
    type = "man_hex_dt",
    node = "locator2_passer_04_05",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_06",
    type = "man_hex_dt",
    node = "locator2_passer_04_06",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_07",
    type = "wom_hex_dt",
    node = "locator2_passer_04_07",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_08",
    type = "wom_hex_dt",
    node = "locator2_passer_04_08",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_09",
    type = "wom_hex_dt",
    node = "locator2_passer_04_09",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_10",
    type = "wom_hex_dt",
    node = "locator2_passer_04_10",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_11",
    type = "wom_hex_dt",
    node = "locator2_passer_04_11",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_12",
    type = "wom_hex_dt",
    node = "locator2_passer_04_12",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_13",
    type = "chi_hex_dt",
    node = "locator2_passer_04_13",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_14",
    type = "chi_hex_dt",
    node = "locator2_passer_04_14",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_15",
    type = "chi_hex_dt",
    node = "locator2_passer_04_15",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_16",
    type = "chi_hex_dt",
    node = "locator2_passer_04_16",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_17",
    type = "man_hex_dt",
    node = "locator2_passer_04_17",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_18",
    type = "man_hex_dt",
    node = "locator2_passer_04_18",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_19",
    type = "man_hex_dt",
    node = "locator2_passer_04_19",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_20",
    type = "man_hex_dt",
    node = "locator2_passer_04_20",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_21",
    type = "man_hex_dt",
    node = "locator2_passer_04_21",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_22",
    type = "man_hex_dt",
    node = "locator2_passer_04_22",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_23",
    type = "wom_hex_dt",
    node = "locator2_passer_04_23",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_24",
    type = "wom_hex_dt",
    node = "locator2_passer_04_24",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_25",
    type = "wom_hex_dt",
    node = "locator2_passer_04_25",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_26",
    type = "wom_hex_dt",
    node = "locator2_passer_04_26",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_27",
    type = "wom_hex_dt",
    node = "locator2_passer_04_27",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_28",
    type = "wom_hex_dt",
    node = "locator2_passer_04_28",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_29",
    type = "chi_hex_dt",
    node = "locator2_passer_04_29",
    active = false,
    not_mob = true
  },
  {
    name = "sm26_passer_05_30",
    type = "chi_hex_dt",
    node = "locator2_passer_04_30",
    active = false,
    not_mob = true
  }
}
_clear_line_up_chara_table = L0_0
L0_0 = {
  {
    look_01 = "man01_lookaround_00",
    look_02 = "man01_lookaround_01"
  },
  {
    look_01 = "wom01_lookaround_00",
    look_02 = "wom01_lookaround_01"
  },
  {
    look_01 = "chi01_lookaround_00",
    look_02 = "chi01_lookaround_01"
  }
}
_release_motion = L0_0
BALLOON_CHAR_TYPE = "man01"
STUDENT_CHAR_TYPE = "man70"
ACCORDION_CHAR_TYPE = "man02"
POLICE_CHAR_TYPE = "man31"
L0_0 = {}
L0_0.man31 = "locator2_bonus_action_juggler"
L0_0.man02 = "locator2_bonus_action_accordion"
L0_0.man01 = "locator2_bonus_action_balloon"
L0_0.man70 = "locator2_bonus_action_juggler"
BONUS_LOCATOR_TBL = L0_0
L0_0 = {}
L0_0.man31 = "locator2_guest_juggler_"
L0_0.man02 = "locator2_guest_accordion_"
L0_0.man01 = "locator2_guest_balloon_"
L0_0.man70 = "locator2_guest_juggler_"
BONUS_GUEST_MT_LOCATOR_TBL = L0_0
L0_0 = {}
L0_0.man31 = "bonus_juggler"
L0_0.man02 = "bonus_accordion"
L0_0.man01 = "bonus_balloon"
L0_0.man70 = "bonus_juggler"
BONUS_GUEST_LOCATOR_TBL = L0_0
L0_0 = {}
L0_0.POLICE = POLICE_CHAR_TYPE
L0_0.ACCORDION = ACCORDION_CHAR_TYPE
L0_0.BALLOON = BALLOON_CHAR_TYPE
L0_0.STUDENT = STUDENT_CHAR_TYPE
BONUS_TYPE_TBL = L0_0
L0_0 = {}
GROUP_TBL = L0_0
L0_0 = {
  POLICE_CHAR_TYPE,
  ACCORDION_CHAR_TYPE,
  BALLOON_CHAR_TYPE,
  STUDENT_CHAR_TYPE
}
BONUS_ACTION_TYPES = L0_0
L0_0 = {
  "man_hex_dt",
  "wom_hex_dt",
  "chi_hex_dt"
}
BONUS_GUEST_TYPES = L0_0
BONUS_CHILD_TYPES = "chi_hex"
L0_0 = {
  "man70",
  "man71",
  "wom38",
  "wom39",
  "wom40"
}
BONUS_STUDENT_TYPES = L0_0
L0_0 = {
  0,
  1,
  0,
  0
}
GAME_TIME = L0_0
L0_0 = {
  {delta_score = 10, add_sec = 10},
  {delta_score = 10, add_sec = 10},
  {delta_score = 10, add_sec = 10},
  {delta_score = 10, add_sec = 10},
  {delta_score = 10, add_sec = 10},
  {delta_score = 10, add_sec = 10},
  {delta_score = 15, add_sec = 10},
  {delta_score = 15, add_sec = 10},
  {delta_score = 15, add_sec = 10},
  {delta_score = 15, add_sec = 5}
}
BONUS_TIME_DATA = L0_0
L0_0 = {
  20,
  40,
  60
}
NEED_MIN_POINT_TBL = L0_0
DEL_TRAIN_NAVI_TIME = 20
DEL_TRAIN_NAVI_DIST = 10
TRAIN_NAVI_MIN_TIME = 5
FRAME_MAX = 30
_bonus_time_idx = 1
_bonus_time_score_tmp = 0
_challenge_No = nil
_set_up_balloon_task = nil
L0_0 = {}
_bonus_again_task = L0_0
L0_0 = "_bonus_guest_count"
_ENV[L0_0] = {}
L0_0 = "_bonus_npc_out"
_ENV[L0_0] = {}
L0_0 = "SM26_Initialize"
_ENV[L0_0] = function(A0_1, A1_2)
  local L2_3, L3_4, L4_5, L5_6, L6_7
  if A0_1 == nil then
    A0_1 = false
  end
  _challenge_No = A1_2
  if A0_1 == false then
    L2_3()
    L2_3.sm26_client = L3_4
    L2_3(L3_4)
    for L5_6, L6_7 in L2_3(L3_4) do
      _puppets[L6_7.name] = Fn_findNpcPuppet(L6_7.name)
      Fn_loadNpcEventMotion(L6_7.name, NPC_MOTION)
    end
    L2_3(L3_4, L4_5)
    L2_3(L3_4, L4_5)
    _clear_lineup_node = L2_3
  end
  _walk_start_group_max = 0
  while true do
    L5_6 = _walk_start_group_max
    L5_6 = L5_6 + 1
    L5_6 = "locator2_"
    L6_7 = L2_3
    L5_6 = L5_6 .. L6_7
    if L3_4 ~= nil then
      _walk_start_group_max = L4_5
    end
  end
  L5_6 = 5
  L5_6 = 6.6
  L6_7 = 11
  if L4_5 == 15 then
    L5_6 = 4
    L6_7 = 9.7
    L5_6 = 10
    L6_7 = 6.6
    L5_6 = "man_hex_ed"
    L6_7 = "wom_hex_ed"
    BONUS_GUEST_TYPES = L4_5
  end
  L5_6 = "Node"
  L6_7 = "locator2_goal_maker"
  L6_7 = L4_5
  L5_6 = L4_5.getWorldTransform
  L6_7 = L5_6(L6_7)
  _goal_maker = RAC_createGameObject2("goal_maker", "MapMarker", L5_6, L6_7)
  _goal_maker:setAssetName("gui_marker_30")
  _goal_maker:setupPattern("C", L3_4)
  _goal_maker:setActive(false)
  start_game_obj()
  L5_6 = "lineup_01"
  L6_7 = "locator2_lineup_"
  _guest_lineup_node = L4_5
  L5_6 = L4_5
  L6_7 = "npc"
  L4_5(L5_6, L6_7, Player.kGrabPickupPrio_High)
  L5_6 = L4_5
  L6_7 = "mob"
  L4_5(L5_6, L6_7, Player.kGrabPickupPrio_High)
  L5_6 = L4_5
  L6_7 = "gimmickbg"
  L4_5(L5_6, L6_7)
  L5_6 = L4_5
  L6_7 = 10
  L4_5(L5_6, L6_7)
  L5_6 = "Node"
  L6_7 = "locator2_mob_sensor"
  if L4_5 ~= nil then
    L6_7 = L4_5
    L5_6 = L4_5.getWorldPos
    L5_6 = L5_6(L6_7)
    L6_7 = createCubeSensor
    L6_7("mob_sensor", L5_6, L2_3, findGameObject2("Node", "locator2_mob_sensor"))
  end
end
L0_0 = "SM26_InitGameParam"
_ENV[L0_0] = function()
  _mobs = {}
  _guests = {}
  _guest_ready = {}
  _guest_move = {}
  _guest_goal = {}
  _guest_finish = {}
  _guest_lineup_task = {}
  _guest_grab = {}
  _score = 0
  _bonus_action_task = {}
  _bonus_action_name = {}
  _bonus_guest_table = {}
  _bonus_again_task = {}
  _bonus_guest_count = {}
  _bonus_npc_out = {}
  Player:setGrabThrowLimit(GRABTHROW_RANGE_LIMIT, GRABTHROW_TIME_LIMIT)
  setupMob()
  Mob:topUpHatchery()
end
L0_0 = "SM26_SetSwpawnGroup"
_ENV[L0_0] = function()
  local L0_8
  L0_8 = _challenge_No
  if L0_8 == 14 then
    L0_8 = {
      {
        group_name = POLICE_CHAR_TYPE
      },
      {
        group_name = ACCORDION_CHAR_TYPE
      },
      {
        group_name = BALLOON_CHAR_TYPE
      }
    }
    GROUP_TBL = L0_8
  else
    L0_8 = _challenge_No
    if L0_8 == 15 then
      L0_8 = {
        {
          group_name = STUDENT_CHAR_TYPE
        },
        {
          group_name = ACCORDION_CHAR_TYPE
        },
        {
          group_name = BALLOON_CHAR_TYPE
        }
      }
      GROUP_TBL = L0_8
    end
  end
end
L0_0 = "SM26_MobReset"
_ENV[L0_0] = function()
  Mob:topUpHatchery()
  Mob:letStateMode(Mob.StateMode.kGrabbed, false)
  Mob:letStateMode(Mob.StateMode.kGrabThrowing, false)
end
L0_0 = "SM26_playClientMotionTask"
_ENV[L0_0] = function()
  return invokeTask(function()
    local L0_9
    while true do
      L0_9 = RandF
      L0_9 = L0_9(1, 3)
      Fn_playMotionNpc("sm26_client", CLIENT_MOTION_TBL[RandI(1, #CLIENT_MOTION_TBL)], true, {animBlendDuration = 0.3})
      Fn_playMotionNpc("sm26_client", "stay", false, {animBlendDuration = 0.3})
      if L0_9 > 0 then
        waitSeconds(L0_9)
      end
      wait()
    end
  end)
end
L0_0 = "SM26_InvokeTimeTask"
_ENV[L0_0] = function(A0_10, A1_11, A2_12, A3_13)
  return invokeTask(function()
    local L0_14, L1_15, L2_16, L3_17, L4_18, L5_19, L6_20, L7_21, L8_22, L9_23, L10_24
    L0_14 = 1
    L1_15 = 0
    L2_16 = 0
    while true do
      L1_15 = L1_15 + 1
      L3_17 = FRAME_MAX
      L3_17 = L1_15 % L3_17
      if L3_17 == 0 then
        L2_16 = L2_16 + 1
      end
      L3_17 = GAME_CLEAR_SCORE
      L3_17 = L3_17 - L4_18
      L3_17 = L3_17 <= L4_18
      if L4_18 ~= nil then
        L4_18()
        L3_17 = false
      end
      if L0_14 <= L4_18 then
        if L2_16 >= L4_18 or L3_17 == true then
          L4_18(L5_19)
          if L4_18 ~= nil then
            if L5_19 == nil then
              L5_19()
            end
            L5_19(L6_20)
          else
          end
          L4_18(L5_19)
          L4_18()
          L0_14 = L0_14 + 1
        end
      end
      for L7_21, L8_22 in L4_18(L5_19) do
        L9_23 = _guest_ready
        L9_23 = L9_23[L7_21]
        if L9_23 ~= nil then
          L9_23 = _guest_ready
          L9_23 = L9_23[L7_21]
          L10_24 = L9_23
          L9_23 = L9_23.isRunning
          L9_23 = L9_23(L10_24)
          if not L9_23 then
            L9_23 = string
            L9_23 = L9_23.match
            L10_24 = L7_21
            L9_23 = L9_23(L10_24, "[^0-9]+")
            if L9_23 ~= "bonus_action" then
              L10_24 = _guest_ready
              L10_24 = L10_24[L7_21]
              L10_24 = L10_24.abort
              L10_24(L10_24)
              L10_24 = _guest_ready
              L10_24[L7_21] = nil
            end
          end
        end
      end
      for L7_21, L8_22 in L4_18(L5_19) do
        L9_23 = _guest_move
        L9_23 = L9_23[L7_21]
        if L9_23 ~= nil then
          L9_23 = _guest_move
          L9_23 = L9_23[L7_21]
          L10_24 = L9_23
          L9_23 = L9_23.isRunning
          L9_23 = L9_23(L10_24)
          if not L9_23 then
            L9_23 = _guest_move
            L9_23 = L9_23[L7_21]
            L10_24 = L9_23
            L9_23 = L9_23.abort
            L9_23(L10_24)
            L9_23 = _guest_move
            L9_23[L7_21] = nil
            L9_23 = string
            L9_23 = L9_23.find
            L10_24 = L7_21
            L9_23 = L9_23(L10_24, "bonus")
            L9_23 = L9_23 ~= nil
            if L9_23 == false then
              L10_24 = releaseNpcToMob
              L10_24(L7_21)
            else
              L10_24 = _guest_goal
              L10_24 = L10_24[L7_21]
              if L10_24 then
                L10_24 = releaseNpcToMob
                L10_24(L7_21)
              end
            end
          end
        end
      end
      for L7_21, L8_22 in L4_18(L5_19) do
        L9_23 = Fn_findNpc
        L10_24 = L7_21
        L9_23 = L9_23(L10_24)
        if L9_23 ~= nil then
          L10_24 = L9_23.getActive
          L10_24 = L10_24(L9_23)
          if L10_24 then
            L10_24 = _guests
            L10_24 = L10_24[L7_21]
            if L10_24 ~= nil then
              L10_24 = _guests
              L10_24 = L10_24[L7_21]
              L10_24 = L10_24.isGrabbed
              L10_24 = L10_24(L10_24)
              if L10_24 then
                L10_24 = _guest_release_task
                L10_24 = L10_24[L7_21]
                L10_24 = L10_24.abort
                L10_24(L10_24)
                L10_24 = _guest_release_task
                L10_24[L7_21] = nil
              end
            end
          end
        end
      end
      if L4_18 ~= nil then
        L7_21 = _bonus_time_idx
        if L4_18 >= L5_19 then
          L7_21 = BONUS_TIME_DATA
          L8_22 = _bonus_time_idx
          L7_21 = L7_21[L8_22]
          L7_21 = L7_21.add_sec
          L7_21 = L4_18 + L7_21
          L5_19(L6_20, L7_21)
          L7_21 = "sys_info"
          L8_22 = 1
          L5_19(L6_20, L7_21, L8_22)
          L5_19(L6_20)
          L7_21 = _bonus_time_idx
          _bonus_time_score_tmp = L5_19
          L7_21 = BONUS_TIME_DATA
          L7_21 = #L7_21
          _bonus_time_idx = L5_19
        end
      end
      for L7_21, L8_22 in L4_18(L5_19) do
        L9_23 = Fn_findNpc
        L10_24 = L7_21
        L9_23 = L9_23(L10_24)
        if L9_23 ~= nil then
          L10_24 = L9_23.getActive
          L10_24 = L10_24(L9_23)
          if L10_24 then
            L10_24 = _guest_lineup_task
            L10_24 = L10_24[L7_21]
            if L10_24 == nil then
              L10_24 = string
              L10_24 = L10_24.find
              L10_24 = L10_24(L7_21, "bonus")
              L10_24 = L10_24 ~= nil
              if _guest_goal[L7_21] == false then
                if _guest_grab[L7_21] == false and _guests[L7_21]:isGrabbed() then
                  _guest_grab[L7_21] = true
                  if _guest_move[L7_21] ~= nil then
                    _guest_move[L7_21]:abort()
                    _guest_move[L7_21] = nil
                    Fn_playMotionNpc(L7_21, "stay", false)
                  end
                  if L10_24 and string.find(L7_21, "GUSET") == nil then
                    startLookatMotion(L7_21)
                  end
                elseif _guest_grab[L7_21] == true and not _guests[L7_21]:isGrabbed() and _guest_release_task[L7_21] == nil then
                  _guest_release_task[L7_21] = guestReleaseTask(L7_21)
                end
              elseif L10_24 == false or string.find(L7_21, "GUSET") == nil == false then
                print("_guest_goal.." .. L7_21)
                if _guest_release_task[L7_21] ~= nil then
                  _guest_release_task[L7_21]:abort()
                  _guest_release_task[L7_21] = nil
                end
                if _guest_move[L7_21] ~= nil then
                  _guest_move[L7_21]:abort()
                  _guest_move[L7_21] = nil
                  Fn_playMotionNpc(L7_21, "stay", false)
                end
                Fn_setGrabReleaseNpc(L7_21)
                Fn_setGrabNpc(L7_21, true, true)
                if _guest_lineup_node ~= nil then
                  _guest_lineup_task[L7_21] = addLineup("lineup_01", L7_21, _guest_lineup_node)
                end
                if _guest_lineup_task[L7_21] == nil then
                  RAC_setLineupIndex("lineup_01", L7_21, nil)
                  print("\232\161\140\229\136\151\230\186\128\229\147\161.." .. L7_21)
                  releaseNpcToMob(L7_21)
                end
              elseif _bonus_again_task[L7_21] == nil then
                _bonus_again_task[L7_21] = invokeTask(function()
                  moveBonusTo(L7_21)
                  moveGuestTo(L7_21)
                end)
              end
            end
          end
        else
        end
      end
      for L7_21, L8_22 in L4_18(L5_19) do
        L9_23 = Fn_findNpc
        L10_24 = L7_21
        L9_23 = L9_23(L10_24)
        if L9_23 ~= nil then
          L10_24 = L9_23.getActive
          L10_24 = L10_24(L9_23)
        else
          if not L10_24 then
            L10_24 = RAC_setLineupIndex
            L10_24("lineup_01", L7_21, nil)
            L10_24 = finalizeNpc
            L10_24(L7_21)
        end
        else
          L10_24 = _guest_lineup_task
          L10_24 = L10_24[L7_21]
          if L10_24 ~= nil then
            L10_24 = _guest_lineup_task
            L10_24 = L10_24[L7_21]
            L10_24 = L10_24.isRunning
            L10_24 = L10_24(L10_24)
            if not L10_24 then
              L10_24 = RAC_setLineupIndex
              L10_24("lineup_01", L7_21, nil)
              L10_24 = finalizeNpc
              L10_24(L7_21)
            end
          end
        end
      end
      for L7_21, L8_22 in L4_18(L5_19) do
        L9_23 = Fn_findNpc
        L10_24 = L7_21
        L9_23 = L9_23(L10_24)
        if L9_23 ~= nil then
          L10_24 = L9_23.getActive
          L10_24 = L10_24(L9_23)
          if L10_24 then
            L10_24 = _guests
            L10_24 = L10_24[L7_21]
            L10_24 = L10_24.isGrabbed
            L10_24 = L10_24(L10_24)
            if L10_24 then
              L10_24 = string
              L10_24 = L10_24.match
              L10_24 = L10_24(L7_21, "bonus_action_")
              if L10_24 ~= nil then
                L10_24 = Fn_findNpcPuppet
                L10_24 = L10_24(L7_21)
                if L10_24 then
                  RAC_MultiNaviDel(L10_24)
                end
              end
            end
          end
        end
      end
      if L4_18 ~= nil then
        L4_18(L5_19, L6_20)
        L4_18(L5_19, L6_20)
        if L5_19 ~= nil then
        else
        end
        L7_21 = L4_18
        L5_19(L6_20, L7_21)
      end
      L4_18()
    end
  end)
end
L0_0 = "SM26_GameLoop"
_ENV[L0_0] = function(A0_25, A1_26)
  local L2_27, L3_28, L4_29, L5_30, L6_31, L7_32, L8_33, L9_34
  if A0_25 == nil then
    A0_25 = false
  end
  L2_27 = true
  L3_28 = nil
  if A0_25 then
    L4_29 = RAC_invokeMobRepopTask
    L4_29 = L4_29(L5_30, L6_31)
    L3_28 = L4_29
  end
  while L2_27 do
    if A0_25 then
      L4_29 = HUD
      L4_29 = L4_29.timerGetSecond
      L4_29 = L4_29(L5_30)
      L2_27 = L4_29 > 0
    else
      L4_29 = GAME_CLEAR_SCORE
      L4_29 = L4_29 - L5_30
      L2_27 = L4_29 > 0
    end
    L4_29 = false
    for L8_33, L9_34 in L5_30(L6_31) do
      if L9_34 ~= nil then
        L4_29 = true
      end
    end
    if L4_29 then
      for L8_33, L9_34 in L5_30(L6_31) do
        if _bonus_action_task[L9_34] == nil then
          print("\228\189\156\230\136\144\227\129\153\227\130\139\227\130\191\227\130\185\227\130\175......" .. L9_34)
          _bonus_action_task[L9_34] = invokeTask(function()
            local L0_35, L1_36, L2_37, L3_38, L4_39, L5_40, L6_41, L7_42, L8_43, L9_44
            L0_35 = L9_34
            L1_36(L2_37, L3_38)
            if L1_36 ~= nil then
              while true do
                if not L1_36 then
                  L1_36()
                  else
                    L1_36(L2_37)
                  end
                end
              end
            for L4_39, L5_40 in L1_36(L2_37) do
              L6_41(L7_42)
              while true do
                if L6_41 ~= nil then
                  L6_41()
                end
              end
            end
            while L2_37 do
              for L7_42, L8_43 in L4_39(L5_40) do
                L9_44 = print
                L9_44("\227\131\156\227\131\188\227\131\138\227\130\185\227\130\173\227\131\163\227\131\169\232\166\150\233\135\142\229\136\164\229\174\154")
                L9_44 = findGameObject2
                L9_44 = L9_44("Node", "locator2_" .. BONUS_GUEST_LOCATOR_TBL[L1_36] .. "_" .. string.format("%02d", L3_38) .. "_pos")
                if L9_44 == nil then
                  L9_44 = findGameObject2("Node", "locator2_" .. BONUS_GUEST_LOCATOR_TBL[L1_36] .. "_" .. string.format("%02d", L3_38) .. "_pos_after")
                end
                if L9_44 ~= nil then
                  if Fn_isInSightTarget(L9_44, 1) then
                    break
                  end
                end
              end
              L4_39()
            end
            L4_39[L0_35] = 0
            L4_39[L0_35] = L5_40
            for L8_43, L9_44 in L5_40(L6_41) do
              print("\227\131\156\227\131\188\227\131\138\227\130\185\233\150\139\229\167\139")
              startBonusGuestStand(L8_43, L1_36)
              _bonus_guest_count[L0_35] = _bonus_guest_count[L0_35] + 1
              L4_39[L0_35][L8_43] = false
            end
            L8_43 = 1
            L5_40(L6_41, L7_42, L8_43)
            if L1_36 == L5_40 then
              L5_40(L6_41)
            elseif L1_36 == L5_40 then
              L5_40(L6_41)
            elseif L1_36 == L5_40 then
              L5_40(L6_41)
            elseif L1_36 == L5_40 then
              L5_40(L6_41)
            end
            L5_40(L6_41)
            while true do
              L5_40()
              for L8_43, L9_44 in L5_40(L6_41) do
                if _guest_goal[L8_43] == true and L4_39[L0_35][L8_43] == false or _guest_release_task[L8_43] and _guest_release_task[L8_43]:isRunning() == false then
                  _bonus_guest_count[L0_35] = _bonus_guest_count[L0_35] - 1
                  L4_39[L0_35][L8_43] = true
                  if _bonus_guest_count[L0_35] <= 0 then
                    releaseNpcToMob(L0_35)
                    _bonus_guest_table[L0_35] = {}
                  end
                end
              end
            end
          end)
          break
        else
        end
      end
    end
    L5_30()
  end
  if L3_28 ~= nil then
    L4_29 = L3_28.abort
    L4_29(L5_30)
    L3_28 = nil
  end
end
L0_0 = "SM26_RespawnClearLineUp"
_ENV[L0_0] = function(A0_45)
  local L1_46, L2_47, L3_48, L4_49, L5_50, L6_51, L7_52
  L1_46 = {}
  for L5_50 = 1, A0_45 do
    L6_51 = "sm26_passer_05_"
    L7_52 = string
    L7_52 = L7_52.format
    L7_52 = L7_52("%02d", L5_50)
    L6_51 = L6_51 .. L7_52
    L7_52 = Fn_findNpc
    L7_52 = L7_52(L6_51)
    L7_52 = L7_52.getActive
    L7_52 = L7_52(L7_52)
    if L7_52 == false then
      L7_52 = table
      L7_52 = L7_52.insert
      L7_52(L1_46, L5_50)
    end
  end
  L2_47(L3_48)
  for L5_50 = 1, #L1_46 do
    L6_51 = RandI
    L7_52 = L5_50
    L6_51 = L6_51(L7_52, #L1_46)
    L7_52 = "sm26_passer_05_"
    L7_52 = L7_52 .. string.format("%02d", L1_46[L6_51])
    print(L7_52 .. " \231\148\159\230\136\144")
    Fn_setNpcActive(L7_52, true)
    playNpcLineUpMotion(L7_52, L5_50, _line_up_ret_max)
    if Fn_findNpc(L7_52) ~= nil and Fn_findNpc(L7_52):isStarted() then
      _guests[L7_52] = Fn_findNpcPuppet(L7_52)
    end
    Fn_warpNpc(L7_52, _clear_lineup_node[L5_50])
    L1_46[L6_51], L1_46[L5_50] = L1_46[L5_50], L1_46[L6_51]
    Fn_findNpc(L7_52):setStagger(true)
  end
end
L0_0 = "playNpcLineUpMotion"
_ENV[L0_0] = function(A0_53, A1_54, A2_55)
  local L3_56, L4_57, L5_58, L6_59
  L3_56 = 0
  L4_57 = Fn_getRandamNpcType
  L5_58 = A0_53
  L4_57 = L4_57(L5_58)
  L5_58 = string
  L5_58 = L5_58.find
  L6_59 = L4_57
  L5_58 = L5_58(L6_59, "man")
  if L5_58 ~= nil then
    L3_56 = 1
  end
  L5_58 = string
  L5_58 = L5_58.find
  L6_59 = L4_57
  L5_58 = L5_58(L6_59, "wom")
  if L5_58 ~= nil then
    L3_56 = 2
  end
  L5_58 = string
  L5_58 = L5_58.find
  L6_59 = L4_57
  L5_58 = L5_58(L6_59, "chi")
  if L5_58 ~= nil then
    L3_56 = 3
  end
  L5_58 = string
  L5_58 = L5_58.find
  L6_59 = L4_57
  L5_58 = L5_58(L6_59, "kid")
  if L5_58 ~= nil then
    L3_56 = 3
  end
  if L3_56 ~= 0 then
    L5_58 = Fn_loadNpcEventMotion
    L6_59 = A0_53
    L5_58(L6_59, _line_up_motion[L3_56])
    L5_58 = RandI
    L6_59 = 1
    L5_58 = L5_58(L6_59, A2_55)
    L6_59 = A1_54 % L5_58
    if L6_59 == 0 then
      A2_55 = RET_MAX
      L6_59 = math
      L6_59 = L6_59.random
      L6_59 = L6_59(1, RAC_GetTableLength(_line_up_motion[L3_56]))
      Fn_playMotionNpc(A0_53, _line_up_motion[L3_56]["_mot" .. string.format("%02d", L6_59)], false)
    else
      L6_59 = Fn_playMotionNpc
      L6_59(A0_53, "stay", false)
      A2_55 = A2_55 - 1
    end
  end
end
L0_0 = "SM26_ClearFinalize"
_ENV[L0_0] = function(A0_60)
  local L1_61, L2_62, L3_63, L4_64
  L1_61()
  L1_61()
  L1_61(L2_62)
  L1_61(L2_62)
  L1_61(L2_62)
  L1_61(L2_62, L3_63)
  if L1_61 ~= nil then
    L1_61(L2_62)
    _set_up_balloon_task = nil
  end
  for L4_64 = 1, #L2_62 do
    _task_dest_manager[L4_64]:abort()
    _task_dest_manager[L4_64] = nil
  end
  _task_dest_manager = L1_61
  for L4_64, _FORV_5_ in L1_61(L2_62) do
    if _guest_ready[L4_64] ~= nil then
      if _guest_ready[L4_64]:isRunning() then
        if string.match(L4_64, "bonus_action") ~= nil and _guest_ready[L4_64].npc_task:isReady() then
          _guest_ready[L4_64]:abort()
          _guest_ready[L4_64] = nil
        end
      else
        _guest_ready[L4_64]:abort()
        _guest_ready[L4_64] = nil
      end
    end
  end
  L1_61(L2_62)
  L1_61(L2_62)
  for L4_64, _FORV_5_ in L1_61(L2_62) do
    finalizeNpc(L4_64, A0_60)
  end
  L1_61()
  L1_61(L2_62, L3_63)
end
L0_0 = "SM26_SetMapMaker"
_ENV[L0_0] = function(A0_65)
  if A0_65 then
    _goal_maker:setActive(true)
  else
    _goal_maker:setActive(false)
  end
end
L0_0 = "setNpcMotion_Bonus"
_ENV[L0_0] = function(A0_66, A1_67)
  local L2_68, L3_69
  L2_68 = BONUS_TYPE_TBL
  L2_68 = L2_68.POLICE
  if A1_67 == L2_68 then
    L2_68 = Fn_playMotionNpc
    L3_69 = A0_66
    L2_68(L3_69, NPC_MOTION.police_stay1, false, {animBlendDuration = 0.3})
  else
    L2_68 = BONUS_TYPE_TBL
    L2_68 = L2_68.ACCORDION
    if A1_67 == L2_68 then
      L2_68 = Fn_playMotionNpc
      L3_69 = A0_66
      L2_68(L3_69, "accordion_00", false, {isRepeat = true})
    else
      L2_68 = BONUS_TYPE_TBL
      L2_68 = L2_68.BALLOON
      if A1_67 == L2_68 then
        L2_68 = Fn_createGimmickBg
        L3_69 = "loc_l_hand"
        L2_68 = L2_68(L3_69, "balloon_01", "ciballoonset00_base")
        L3_69 = Fn_findNpcPuppet
        L3_69 = L3_69(A0_66)
        if L3_69 and L2_68 then
          Fn_attachJoint(L2_68, L3_69, "loc_l_hand")
        end
        Fn_playMotionNpc(A0_66, "man01_balloon_stay_00", false, {animBlendDuration = 0.3})
      else
        L2_68 = BONUS_TYPE_TBL
        L2_68 = L2_68.STUDENT
        if A1_67 == L2_68 then
          L2_68 = {
            L3_69,
            NPC_MOTION.stu_talk01,
            NPC_MOTION.stu_talk02,
            NPC_MOTION.stu_talk03
          }
          L3_69 = NPC_MOTION
          L3_69 = L3_69.stu_talk00
          L3_69 = Fn_playMotionNpc
          L3_69(A0_66, L2_68[RandI(#L2_68)], false, {animBlendDuration = 0.3})
        end
      end
    end
  end
end
L0_0 = "setNpcMotion_Guest"
_ENV[L0_0] = function(A0_70, A1_71)
  if A1_71 == BONUS_TYPE_TBL.POLICE then
    Fn_playMotionNpc(A0_70, NPC_MOTION.police_stay0, false, {animBlendDuration = 0.3})
  elseif A1_71 == BONUS_TYPE_TBL.ACCORDION then
    if string.match(A1_71, "man") ~= nil then
      Fn_playMotionNpc(A0_70, ({
        NPC_MOTION.accor_man_stay01,
        NPC_MOTION.accor_man_stay02,
        NPC_MOTION.accor_man_stay03
      })[RandI(#{
        NPC_MOTION.accor_man_stay01,
        NPC_MOTION.accor_man_stay02,
        NPC_MOTION.accor_man_stay03
      })], false, {animBlendDuration = 0.3})
    elseif string.match(A1_71, "wom") ~= nil then
      Fn_playMotionNpc(A0_70, ({
        NPC_MOTION.accor_wom_stay01,
        NPC_MOTION.accor_wom_stay02,
        NPC_MOTION.accor_wom_stay03
      })[RandI(#{
        NPC_MOTION.accor_wom_stay01,
        NPC_MOTION.accor_wom_stay02,
        NPC_MOTION.accor_wom_stay03
      })], false, {animBlendDuration = 0.3})
    else
      Fn_playMotionNpc(A0_70, ({
        NPC_MOTION.accor_chi_stay01,
        NPC_MOTION.accor_chi_stay02,
        NPC_MOTION.accor_chi_stay03
      })[RandI(#{
        NPC_MOTION.accor_chi_stay01,
        NPC_MOTION.accor_chi_stay02,
        NPC_MOTION.accor_chi_stay03
      })], false, {animBlendDuration = 0.3})
    end
  elseif A1_71 == BONUS_TYPE_TBL.BALLOON then
    Fn_playMotionNpc(A0_70, ({
      NPC_MOTION.balloon_stay01,
      NPC_MOTION.balloon_stay02,
      NPC_MOTION.balloon_stay03
    })[RandI(#{
      NPC_MOTION.balloon_stay01,
      NPC_MOTION.balloon_stay02,
      NPC_MOTION.balloon_stay03
    })], false, {animBlendDuration = 0.3})
  elseif A1_71 == BONUS_TYPE_TBL.STUDENT then
    if string.match(A1_71, "man") ~= nil then
      Fn_playMotionNpc(A0_70, ({
        NPC_MOTION.stu_talk00,
        NPC_MOTION.stu_talk01,
        NPC_MOTION.stu_talk02,
        NPC_MOTION.stu_talk03
      })[RandI(#{
        NPC_MOTION.stu_talk00,
        NPC_MOTION.stu_talk01,
        NPC_MOTION.stu_talk02,
        NPC_MOTION.stu_talk03
      })], false, {animBlendDuration = 0.3})
    else
      Fn_playMotionNpc(A0_70, ({
        NPC_MOTION.stu_wom_talk00,
        NPC_MOTION.stu_wom_talk01,
        NPC_MOTION.stu_wom_talk02,
        NPC_MOTION.stu_wom_talk03
      })[RandI(#{
        NPC_MOTION.stu_wom_talk00,
        NPC_MOTION.stu_wom_talk01,
        NPC_MOTION.stu_wom_talk02,
        NPC_MOTION.stu_wom_talk03
      })], false, {animBlendDuration = 0.3})
    end
  end
end
L0_0 = "moveBonusTo"
_ENV[L0_0] = function(A0_72)
  local L1_73, L2_74, L3_75
  L1_73 = Fn_setGrabReleaseNpc
  L2_74 = A0_72
  L1_73(L2_74)
  L1_73 = Fn_setGrabNpc
  L2_74 = A0_72
  L3_75 = true
  L1_73(L2_74, L3_75, true)
  L1_73 = Fn_getRandamNpcType
  L2_74 = A0_72
  L1_73 = L1_73(L2_74)
  L2_74 = nil
  L3_75 = BONUS_TYPE_TBL
  L3_75 = L3_75.POLICE
  if L1_73 == L3_75 then
    L3_75 = BONUS_GUEST_LOCATOR_TBL
    L2_74 = L3_75[L1_73]
  else
    L3_75 = BONUS_TYPE_TBL
    L3_75 = L3_75.ACCORDION
    if L1_73 == L3_75 then
      L3_75 = BONUS_GUEST_LOCATOR_TBL
      L2_74 = L3_75[L1_73]
    else
      L3_75 = BONUS_TYPE_TBL
      L3_75 = L3_75.BALLOON
      if L1_73 == L3_75 then
        L3_75 = BONUS_GUEST_LOCATOR_TBL
        L2_74 = L3_75[L1_73]
      else
        L3_75 = BONUS_TYPE_TBL
        L3_75 = L3_75.STUDENT
        if L1_73 == L3_75 then
          L3_75 = BONUS_GUEST_LOCATOR_TBL
          L2_74 = L3_75[L1_73]
        end
      end
    end
  end
  L3_75 = nil
  if L2_74 ~= nil and _bonus_guest_count[A0_72] > 0 then
    L3_75 = RAC_invokeMoveCharaTask2(A0_72, {
      "locator2_" .. L2_74
    }, {arrivedLength = 0, runLength = -1}, {goalDirection = true})
  end
  if L3_75 then
    while true do
      if L3_75 ~= nil and not L3_75:isRunning() then
        L3_75:abort()
        L3_75 = nil
        break
      end
      wait()
    end
    setNpcMotion_Bonus(A0_72, L1_73)
  end
end
L0_0 = "moveGuestTo"
_ENV[L0_0] = function(A0_76)
  local L1_77, L2_78, L3_79, L4_80, L5_81, L6_82, L7_83, L8_84, L9_85, L10_86
  L1_77 = Fn_getRandamNpcType
  L2_78 = A0_76
  L1_77 = L1_77(L2_78)
  L2_78 = "bonus_action_"
  L3_79 = L1_77
  L2_78 = L2_78 .. L3_79
  L3_79 = 1
  L4_80 = {}
  for L8_84, L9_85 in L5_81(L6_82) do
    L10_86 = Fn_setNpcActive
    L10_86(L8_84, true)
    L10_86 = findGameObject2
    L10_86 = L10_86("Node", BONUS_GUEST_MT_LOCATOR_TBL[L1_77] .. string.format("%02d", L3_79) .. "_pos")
    if L10_86 ~= nil and _guest_goal[L8_84] == false then
      L4_80[L8_84] = invokeTask(function()
        _guest_move[L8_84] = Fn_moveNpc(L8_84, {
          L10_86:getName()
        }, {arrivedLength = 0, runLength = -1}, {goalDirection = true})
        while true do
          if _guest_move[L8_84] ~= nil then
            wait()
            if _guest_move[L8_84] and not _guest_move[L8_84]:isRunning() then
              _guest_move[L8_84]:abort()
              _guest_move[L8_84] = nil
              waitSeconds(RandI(2))
              setNpcMotion_Guest(L8_84, L1_77)
              break
            end
            if _guest_move[L8_84] == nil or _guests[L8_84] and _guests[L8_84]:isGrabbed() then
              RAC_stopNpcMoveTask(L8_84, _guest_move[L8_84])
              break
            end
          end
        end
      end)
    end
    L3_79 = L3_79 + 1
    do break end
    break
  end
  for L8_84, L9_85 in L5_81(L6_82) do
    L10_86 = L4_80[L8_84]
    while true do
      if L10_86 ~= nil then
        L10_86 = wait
        L10_86()
        L10_86 = L4_80[L8_84]
        if L10_86 then
          L10_86 = L4_80[L8_84]
          L10_86 = L10_86.isRunning
          L10_86 = L10_86(L10_86)
          if not L10_86 then
            L10_86 = L4_80[L8_84]
            L10_86 = L10_86.abort
            L10_86(L10_86)
            L4_80[L8_84] = nil
            break
          end
        end
      end
    end
  end
  L4_80 = L5_81
end
L0_0 = "startLookatMotion"
_ENV[L0_0] = function(A0_87)
  local L1_88, L2_89, L3_90, L4_91, L5_92, L6_93, L7_94, L8_95, L9_96, L10_97, L11_98
  L1_88 = Fn_getRandamNpcType
  L2_89 = A0_87
  L1_88 = L1_88(L2_89)
  L2_89 = "bonus_action_"
  L2_89 = L2_89 .. L3_90
  for L6_93, L7_94 in L3_90(L4_91) do
    L8_95 = 0
    L9_96 = Fn_findNpc
    L10_97 = L6_93
    L9_96 = L9_96(L10_97)
    L10_97 = Fn_getRandamNpcType
    L11_98 = L6_93
    L10_97 = L10_97(L11_98)
    L11_98 = string
    L11_98 = L11_98.find
    L11_98 = L11_98(L10_97, "man")
    if L11_98 ~= nil then
      L8_95 = 1
    end
    L11_98 = string
    L11_98 = L11_98.find
    L11_98 = L11_98(L10_97, "wom")
    if L11_98 ~= nil then
      L8_95 = 2
    end
    L11_98 = string
    L11_98 = L11_98.find
    L11_98 = L11_98(L10_97, "chi")
    if L11_98 ~= nil then
      L8_95 = 3
    end
    L11_98 = string
    L11_98 = L11_98.find
    L11_98 = L11_98(L10_97, "kid")
    if L11_98 ~= nil then
      L8_95 = 3
    end
    if L8_95 ~= 0 then
      if L9_96 then
        L11_98 = Fn_loadNpcEventMotion
        L11_98(L6_93, _release_motion[L8_95])
        L11_98 = math
        L11_98 = L11_98.random
        L11_98 = L11_98(1, RAC_GetTableLength(_release_motion[L8_95]))
        Fn_playMotionNpc(L6_93, "stay", false)
      end
      L11_98 = wait
      L11_98()
    end
  end
end
L0_0 = "setupWalk"
_ENV[L0_0] = function(A0_99)
  local L1_100, L2_101, L3_102, L4_103, L5_104, L6_105, L7_106, L8_107, L9_108, L10_109
  for L4_103 = 1, _walk_start_group_max do
    L5_104 = "bonus_train_"
    L5_104 = L5_104 .. L6_105
    for L9_108 = 1, BONUS_TRAIN_GROUP_PER_NUM do
      L10_109 = findGameObject2
      L10_109 = L10_109("Node", "locator2_" .. L5_104)
      if Fn_isInSightTarget(L10_109, 1) then
        while RAC_RaycastEyeSight(L10_109, Fn_getDistanceToPlayer(L10_109) + 1, 180) do
          wait()
        end
      end
    end
    for L9_108 = 1, BONUS_TRAIN_GROUP_PER_NUM do
      L10_109 = "train_guest_"
      L10_109 = L10_109 .. string.format("%02d", L4_103) .. "_" .. string.format("%03d", L4_103 + L9_108) .. string.format("%02d", A0_99)
      if _walk_table[L10_109] == nil then
        _guest_ready[L10_109] = invokeTask(function()
          local L0_110, L1_111, L2_112, L3_113, L4_114, L5_115
          L0_110 = BONUS_GUEST_TYPES
          L1_111 = math
          L1_111 = L1_111.random
          L2_112 = BONUS_GUEST_TYPES
          L2_112 = #L2_112
          L1_111 = L1_111(L2_112)
          L0_110 = L0_110[L1_111]
          L1_111 = {L2_112}
          L2_112 = {}
          L3_113 = L10_109
          L2_112.name = L3_113
          L2_112.type = L0_110
          L3_113 = "locator2_"
          L4_114 = L5_104
          L3_113 = L3_113 .. L4_114
          L2_112.node = L3_113
          L2_112.attach = false
          L2_112.active = false
          L2_112.start = true
          L2_112 = Fn_setupNpc
          L3_113 = L1_111
          L2_112(L3_113)
          L2_112 = _guests
          L3_113 = L10_109
          L4_114 = Fn_findNpcPuppet
          L5_115 = L10_109
          L4_114 = L4_114(L5_115)
          L2_112[L3_113] = L4_114
          L2_112 = _walk_table
          L3_113 = L10_109
          L4_114 = L1_111[1]
          L2_112[L3_113] = L4_114
          L2_112 = Fn_findNpc
          L3_113 = L10_109
          L2_112 = L2_112(L3_113)
          while true do
            L4_114 = L2_112
            L3_113 = L2_112.isStarted
            L3_113 = L3_113(L4_114)
            if not L3_113 then
              L3_113 = wait
              L3_113()
            end
          end
          L3_113 = nil
          repeat
            L5_115 = L2_112
            L4_114 = L2_112.getWorldTransform
            L5_115 = L4_114(L5_115)
            L4_114.y = L4_114.y + 0.5
            Query:setEyeSightRange(4)
            Query:setEyeSightAngle(Deg2Rad(180))
            Query:setEyeSightTransform(L4_114, L5_115)
            L4_114.x = L4_114.x + math.random(0, 3)
            L4_114.z = L4_114.z + math.random(0, 3)
            L3_113 = L4_114
          until Query:raycastEyeSight(L3_113) == nil
          L5_115 = L2_112
          L4_114 = L2_112.setWorldPos
          L4_114(L5_115, L3_113)
          L4_114 = invokeTask
          function L5_115()
            startWalk(L5_104, L10_109)
          end
          L4_114(L5_115)
        end)
      else
      end
    end
    break
  end
end
L0_0 = "startWalk"
_ENV[L0_0] = function(A0_116, A1_117)
  Fn_setNpcActive(A1_117, true)
  Fn_setGrabNpc(A1_117, false, true)
  Fn_findNpc(A1_117):setStagger(true)
  Fn_findNpc(A1_117):setIgnoreGrabThrow(false)
  _guest_goal[A1_117] = false
  _guest_grab[A1_117] = false
  _guest_lineup_task[A1_117] = nil
  _guest_move[A1_117] = RAC_invokeMoveCharaTask(A1_117, "locator2_bonus_train_move_", {
    arrivedLength = 0,
    runLength = 1000,
    anim_walk_speed = 1.5,
    anim_speed_over = true,
    recast = true
  })
end
L0_0 = "_setPoliceNpc"
_ENV[L0_0] = function(A0_118, A1_119, A2_120, A3_121)
  local L4_122
  if A2_120 == nil then
    A2_120 = true
  end
  if A3_121 == nil then
    A3_121 = false
  end
  L4_122 = {}
  L4_122.npc_tbl = {}
  L4_122.ready_flg = false
  function L4_122.update(A0_123)
    local L1_124
    L1_124 = {
      {
        name = A0_118,
        type = "man31",
        node = A1_119,
        attach = false,
        active = A2_120,
        start = A3_121
      }
    }
    Fn_setupNpc(L1_124)
    for _FORV_5_, _FORV_6_ in pairs(L1_124) do
      A0_123.npc_tbl[_FORV_6_.name] = Fn_findNpcPuppet(_FORV_6_.name)
      while not A0_123.npc_tbl[_FORV_6_.name]:isStarted() do
        wait()
      end
    end
    Fn_loadNpcEventMotion(A0_118, NPC_MOTION)
    Fn_playMotionNpc(A0_118, NPC_MOTION.police_stay1, false, {animBlendDuration = 0.3})
    A0_123.ready_flg = true
    while true do
      wait()
    end
  end
  function L4_122.destractor(A0_125)
    A0_125:finalize()
  end
  function L4_122.isReady(A0_126)
    local L1_127
    L1_127 = A0_126.ready_flg
    return L1_127
  end
  function L4_122.finalize(A0_128)
    for _FORV_4_, _FORV_5_ in pairs(A0_128.npc_tbl) do
      if Fn_findNpc(_FORV_5_.name) ~= nil then
        if not Fn_findNpc(_FORV_5_.name):isStarted() then
          while not Fn_findNpc(_FORV_5_.name):isStarted() do
            wait()
          end
          Fn_disappearNpc(_FORV_5_.name)
        else
          Fn_disappearNpc(_FORV_5_.name)
        end
      end
    end
  end
  RAC_InvokeTaskWithDestractor(L4_122.update, L4_122.destractor, L4_122).npc_task = L4_122
  return (RAC_InvokeTaskWithDestractor(L4_122.update, L4_122.destractor, L4_122))
end
L0_0 = "_setStudentNpc"
_ENV[L0_0] = function(A0_129, A1_130, A2_131, A3_132, A4_133)
  local L5_134
  if A4_133 == nil then
    A4_133 = false
  end
  if A2_131 == nil then
    A2_131 = true
  end
  if A3_132 == nil then
    A3_132 = false
  end
  L5_134 = {}
  L5_134.npc_tbl = {}
  L5_134.ready_flg = false
  function L5_134.update(A0_135)
    local L1_136
    L1_136 = {
      {
        name = A0_129,
        type = "man70",
        node = A1_130,
        attach = false,
        active = A2_131,
        start = A3_132
      }
    }
    Fn_setupNpc(L1_136)
    for _FORV_5_, _FORV_6_ in pairs(L1_136) do
      A0_135.npc_tbl[_FORV_6_.name] = Fn_findNpcPuppet(_FORV_6_.name)
      while not A0_135.npc_tbl[_FORV_6_.name]:isStarted() do
        wait()
      end
    end
    if A4_133 == true then
      Fn_loadNpcEventMotion(A0_129, NPC_MOTION)
      Fn_playMotionNpc(A0_129, NPC_MOTION.stu_talk00, false, {animBlendDuration = 0.3})
    end
    A0_135.ready_flg = true
    while true do
      wait()
    end
  end
  function L5_134.destractor(A0_137)
    A0_137:finalize()
  end
  function L5_134.isReady(A0_138)
    local L1_139
    L1_139 = A0_138.ready_flg
    return L1_139
  end
  function L5_134.finalize(A0_140)
    for _FORV_4_, _FORV_5_ in pairs(A0_140.npc_tbl) do
      if Fn_findNpc(_FORV_5_.name) ~= nil then
        if not Fn_findNpc(_FORV_5_.name):isStarted() then
          while not Fn_findNpc(_FORV_5_.name):isStarted() do
            wait()
          end
          Fn_disappearNpc(_FORV_5_.name)
        else
          Fn_disappearNpc(_FORV_5_.name)
        end
      end
    end
  end
  RAC_InvokeTaskWithDestractor(L5_134.update, L5_134.destractor, L5_134).npc_task = L5_134
  return (RAC_InvokeTaskWithDestractor(L5_134.update, L5_134.destractor, L5_134))
end
L0_0 = "setupMob"
_ENV[L0_0] = function()
  if _mob_to_npc_task == nil then
    Fn_createChangeMobToNpc(_mob_to_npc_table, {
      attach = true,
      grab = Mob.SwitchMethod.kAfterGrabbed
    })
    _mob_to_npc_task = invokeTask(function()
      local L0_141, L1_142, L2_143, L3_144, L4_145, L5_146, L6_147, L7_148, L8_149, L9_150
      while true do
        L0_141 = {}
        for L4_145, L5_146 in L1_142(L2_143) do
          if L6_147 == nil then
            if L6_147 ~= nil then
              if L7_148 then
                L9_150 = false
                L7_148(L8_149, L9_150, true)
                L9_150 = false
                L7_148(L8_149, L9_150)
                L9_150 = Fn_findNpcPuppet
                L9_150 = L9_150(L5_146.name)
                L7_148[L8_149] = L9_150
                L9_150 = _guests
                L9_150 = L9_150[L5_146.name]
                L7_148[L8_149] = L9_150
                L7_148[L8_149] = nil
                if L7_148 == true then
                  L7_148[L8_149] = true
                else
                  L7_148[L8_149] = false
                end
                L7_148[L8_149] = true
                L7_148[L8_149] = nil
                L9_150 = L5_146.name
                L7_148(L8_149, L9_150)
              end
            end
          end
        end
        for L4_145, L5_146 in L1_142(L2_143) do
          for L9_150, _FORV_10_ in L6_147(L7_148) do
            if _mob_to_npc_table[L9_150].name == L5_146 then
              table.remove(_mob_to_npc_table, L9_150)
              break
            end
          end
        end
        L1_142()
      end
    end)
    Mob:letStateMode(Mob.StateMode.kGrabbed, true)
    Mob:letStateMode(Mob.StateMode.kGrabThrowing, true)
  end
end
L0_0 = "setupBonus"
_ENV[L0_0] = function(A0_151, A1_152)
  local L2_153, L3_154, L4_155, L5_156, L6_157, L7_158, L8_159
  L2_153 = findGameObject2
  L3_154 = "Node"
  L4_155 = BONUS_LOCATOR_TBL
  L4_155 = L4_155[A1_152]
  L2_153 = L2_153(L3_154, L4_155)
  if L2_153 ~= nil then
    L3_154 = BONUS_TYPE_TBL
    L3_154 = L3_154.POLICE
    if A1_152 == L3_154 then
      L3_154 = _guest_ready
      L4_155 = _setPoliceNpc
      L5_156 = A0_151
      L7_158 = L2_153
      L6_157 = L2_153.getName
      L6_157 = L6_157(L7_158)
      L7_158 = false
      L8_159 = true
      L4_155 = L4_155(L5_156, L6_157, L7_158, L8_159)
      L3_154[A0_151] = L4_155
    else
      L3_154 = BONUS_TYPE_TBL
      L3_154 = L3_154.ACCORDION
      if A1_152 == L3_154 then
        L3_154 = _guest_ready
        L4_155 = RAC_setAccordionNpc
        L5_156 = A0_151
        L6_157 = A1_152
        L8_159 = L2_153
        L7_158 = L2_153.getName
        L7_158 = L7_158(L8_159)
        L8_159 = false
        L4_155 = L4_155(L5_156, L6_157, L7_158, L8_159, true)
        L3_154[A0_151] = L4_155
      else
        L3_154 = BONUS_TYPE_TBL
        L3_154 = L3_154.BALLOON
        if A1_152 == L3_154 then
          L3_154 = _guest_ready
          L4_155 = RAC_setBalloonNpc
          L5_156 = A0_151
          L6_157 = A1_152
          L8_159 = L2_153
          L7_158 = L2_153.getName
          L7_158 = L7_158(L8_159)
          L8_159 = false
          L4_155 = L4_155(L5_156, L6_157, L7_158, L8_159, true)
          L3_154[A0_151] = L4_155
        else
          L3_154 = BONUS_TYPE_TBL
          L3_154 = L3_154.STUDENT
          if A1_152 == L3_154 then
            L3_154 = _guest_ready
            L4_155 = _setStudentNpc
            L5_156 = A0_151
            L7_158 = L2_153
            L6_157 = L2_153.getName
            L6_157 = L6_157(L7_158)
            L7_158 = false
            L8_159 = true
            L4_155 = L4_155(L5_156, L6_157, L7_158, L8_159, true)
            L3_154[A0_151] = L4_155
          end
        end
      end
    end
    L3_154 = _bonus_guest_table
    L4_155 = {}
    L3_154[A0_151] = L4_155
    L3_154 = 1
    while true do
      while true do
        L4_155 = BONUS_GUEST_LOCATOR_TBL
        L4_155 = L4_155[A1_152]
        L5_156 = "_"
        L6_157 = string
        L6_157 = L6_157.format
        L7_158 = "%02d"
        L8_159 = L3_154
        L6_157 = L6_157(L7_158, L8_159)
        L4_155 = L4_155 .. L5_156 .. L6_157
        L5_156 = ""
        L6_157 = findGameObject2
        L7_158 = "Node"
        L8_159 = "locator2_"
        L8_159 = L8_159 .. L4_155 .. "_pos"
        L6_157 = L6_157(L7_158, L8_159)
        if L6_157 == nil then
          L7_158 = findGameObject2
          L8_159 = "Node"
          L7_158 = L7_158(L8_159, "locator2_" .. L4_155 .. "_pos_after")
          L6_157 = L7_158
          L5_156 = "_after"
        end
        if L6_157 ~= nil then
          L7_158 = BONUS_GUEST_TYPES
          L8_159 = math
          L8_159 = L8_159.random
          L8_159 = L8_159(#BONUS_GUEST_TYPES)
          L7_158 = L7_158[L8_159]
          L8_159 = BONUS_TYPE_TBL
          L8_159 = L8_159.BALLOON
          if A1_152 == L8_159 then
            L7_158 = BONUS_CHILD_TYPES
          else
            L8_159 = BONUS_TYPE_TBL
            L8_159 = L8_159.POLICE
            if A1_152 == L8_159 then
              L7_158 = "man31"
            else
              L8_159 = BONUS_TYPE_TBL
              L8_159 = L8_159.STUDENT
              if A1_152 == L8_159 then
                L8_159 = BONUS_STUDENT_TYPES
                L7_158 = L8_159[math.random(#BONUS_STUDENT_TYPES)]
              end
            end
          end
          L8_159 = BONUS_GUEST_LOCATOR_TBL
          L8_159 = L8_159[A1_152]
          L8_159 = L8_159 .. "_GUSET_" .. string.format("%02d", L3_154) .. L5_156
          _guest_ready[L8_159] = invokeTask(function()
            local L0_160
            L0_160 = {
              {
                name = L8_159,
                type = L7_158,
                node = L6_157:getName(),
                attach = false,
                active = false,
                start = true
              }
            }
            Fn_setupNpc(L0_160)
            _guests[L8_159] = Fn_findNpcPuppet(L8_159)
            _bonus_guest_table[A0_151][L8_159] = L0_160[1]
            Fn_loadNpcEventMotion(L8_159, NPC_MOTION)
            while _guests[L8_159]:isLoading() do
              wait()
            end
            while not Fn_findNpc(L8_159):isStarted() do
              wait()
            end
          end)
          L3_154 = L3_154 + 1
        end
      end
    end
  end
end
L0_0 = "startBonusAction"
_ENV[L0_0] = function(A0_161)
  local L1_162, L2_163
  L1_162 = string
  L1_162 = L1_162.match
  L2_163 = A0_161
  L1_162 = L1_162(L2_163, "_after")
  if L1_162 == nil then
    L1_162 = Fn_setNpcActive
    L2_163 = A0_161
    L1_162(L2_163, true)
  end
  L1_162 = Fn_setGrabNpc
  L2_163 = A0_161
  L1_162(L2_163, false, true)
  L1_162 = Fn_findNpc
  L2_163 = A0_161
  L1_162 = L1_162(L2_163)
  if L1_162 then
    L2_163 = L1_162.setIgnoreGrabThrow
    L2_163(L1_162, false)
  end
  L2_163 = Fn_findNpcPuppet
  L2_163 = L2_163(A0_161)
  if L2_163 then
    RAC_MultiNaviAdd(L2_163)
    L2_163:setGrabPickupPriorityHigh()
  end
  _guests[A0_161] = L2_163
  _guest_move[A0_161] = nil
  _guest_goal[A0_161] = false
  _guest_grab[A0_161] = false
  _guest_lineup_task[A0_161] = nil
end
L0_0 = "startBonusGuestStand"
_ENV[L0_0] = function(A0_164, A1_165)
  if string.match(A0_164, "_after") == nil then
    Fn_setNpcActive(A0_164, true)
  end
  Fn_setGrabNpc(A0_164, false, true)
  if Fn_findNpc(A0_164) ~= nil then
    Fn_findNpc(A0_164):setStagger(true)
    Fn_findNpc(A0_164):setIgnoreGrabThrow(false)
  else
  end
  setNpcMotion_Guest(A0_164, A1_165)
  _guest_goal[A0_164] = false
  _guest_grab[A0_164] = false
  _guest_lineup_task[A0_164] = nil
end
L0_0 = "finalizeTask"
_ENV[L0_0] = function()
  for _FORV_3_, _FORV_4_ in pairs(_bonus_action_task) do
    if _FORV_4_ ~= nil then
      _bonus_action_task[_FORV_3_]:abort()
      _bonus_action_task[_FORV_3_] = nil
    end
  end
  _bonus_action_task = {}
  for _FORV_3_, _FORV_4_ in pairs(_bonus_again_task) do
    if _FORV_4_ ~= nil then
      _bonus_again_task[_FORV_3_]:abort()
      _bonus_again_task[_FORV_3_] = nil
    end
  end
  _bonus_again_task = {}
end
L0_0 = "finalizeMob"
_ENV[L0_0] = function(A0_166)
  local L1_167, L2_168, L3_169, L4_170
  L1_167()
  if L1_167 ~= nil then
    L1_167(L2_168)
    _mob_to_npc_task = nil
    for L4_170, _FORV_5_ in L1_167(L2_168) do
      finalizeNpc(L4_170, A0_166)
    end
  end
end
L0_0 = "finalizeNpc"
_ENV[L0_0] = function(A0_171, A1_172)
  if _guests[A0_171] ~= nil then
    if _guests[A0_171]:isGrabbed() then
      Fn_setGrabReleaseNpc(A0_171)
    end
    if _guest_move[A0_171] ~= nil then
      _guest_move[A0_171]:abort()
      _guest_move[A0_171] = nil
    end
    if _guest_finish[A0_171] ~= nil then
      _guest_finish[A0_171]:abort()
      _guest_finish[A0_171] = nil
    end
    if _guest_lineup_task[A0_171] ~= nil then
      _guest_lineup_task[A0_171]:abort()
      _guest_lineup_task[A0_171] = nil
    end
    if A1_172 ~= false then
      if _mobs[A0_171] ~= nil then
        Fn_disappearMobToNpc(A0_171)
      else
        Fn_disappearNpc(A0_171)
      end
    end
    _mobs[A0_171] = nil
    _guests[A0_171] = nil
  end
end
L0_0 = "releaseNpcToMob"
_ENV[L0_0] = function(A0_173)
  return invokeTask(function()
    print("releaseNpcToMob.." .. A0_173)
    if _guests[A0_173] ~= nil then
      if _guests[A0_173]:isGrabbed() then
        Fn_setGrabReleaseNpc(A0_173)
      end
      if _guest_move[A0_173] ~= nil then
        _guest_move[A0_173]:abort()
        _guest_move[A0_173] = nil
      end
      if _guest_finish[A0_173] ~= nil then
        _guest_finish[A0_173]:abort()
        _guest_finish[A0_173] = nil
      end
      if _guest_lineup_task[A0_173] ~= nil then
        _guest_lineup_task[A0_173]:abort()
        _guest_lineup_task[A0_173] = nil
      end
      if _guest_release_task[A0_173] ~= nil then
        _guest_release_task[A0_173]:abort()
        _guest_release_task[A0_173] = nil
      end
      if _bonus_again_task[A0_173] ~= nil then
        _bonus_again_task[A0_173]:abort()
        _bonus_again_task[A0_173] = nil
      end
      _mobs[A0_173] = nil
      _guests[A0_173] = nil
      _guest_goal[A0_173] = nil
      _guest_grab[A0_173] = nil
      Fn_changeNpcToMob(A0_173)
    end
  end)
end
L0_0 = "checkNextSpawn"
_ENV[L0_0] = function(A0_174, A1_175)
  local L2_176, L3_177, L4_178
  if A1_175 == nil then
    A1_175 = 15
  end
  L2_176 = GROUP_TBL
  L2_176 = L2_176[A0_174]
  if L2_176 == nil then
    L2_176 = false
    return L2_176
  end
  L2_176 = findGameObject2
  L3_177 = "Node"
  L4_178 = BONUS_LOCATOR_TBL
  L4_178 = L4_178[GROUP_TBL[A0_174].group_name]
  L2_176 = L2_176(L3_177, L4_178)
  if L2_176 == nil then
    L3_177 = false
    return L3_177
  end
  L3_177 = false
  L4_178 = Fn_isInSightTarget
  L4_178 = L4_178(L2_176, 1)
  if L4_178 then
    L4_178 = Fn_getDistanceToPlayer
    L4_178 = L4_178(L2_176)
    if A1_175 < L4_178 then
      L3_177 = RAC_RaycastEyeSight(L2_176, L4_178 + 1, 180)
    else
      return false
    end
  end
  if L3_177 == true then
    L4_178 = GROUP_TBL
    L4_178 = L4_178[A0_174]
    table.remove(GROUP_TBL, A0_174)
    if GROUP_TBL[1] == nil then
      table.insert(GROUP_TBL, L4_178)
      return false
    end
    table.insert(GROUP_TBL, L4_178)
  end
  L4_178 = true
  return L4_178
end
L0_0 = "spawnPasserLargeGroup"
_ENV[L0_0] = function()
  local L0_179, L1_180
  L0_179 = GROUP_TBL
  if L0_179 ~= nil then
    L0_179 = _group_spawn_step
    L0_179 = L0_179 + 1
    L1_180 = math
    L1_180 = L1_180.random
    L1_180 = L1_180(#GROUP_TBL)
    if L0_179 <= #NEED_MIN_POINT_TBL and NEED_MIN_POINT_TBL[L0_179] <= _score and checkNextSpawn(L1_180) == true then
      table.insert(_task_dest_manager, invokeSpawnPasserLargeGroupTask(GROUP_TBL[L1_180].group_name, L1_180))
    end
  end
end
L0_0 = "invokeSpawnPasserLargeGroupTask"
_ENV[L0_0] = function(A0_181, A1_182)
  return invokeTask(function()
    _group_spawn_step = _group_spawn_step + 1
    if _bonus_action_name[A0_181] == nil then
      _bonus_action_name[A0_181] = "bonus_action_" .. A0_181
    end
    table.remove(GROUP_TBL, A1_182)
    if GROUP_TBL[1] == nil then
      GROUP_TBL = nil
    end
  end)
end
L0_0 = "addLineup"
_ENV[L0_0] = function(A0_183, A1_184, A2_185)
  local L3_186, L4_187
  L3_186 = {}
  L4_187 = RAC_addLineup
  L4_187 = L4_187(A0_183)
  if L4_187 ~= nil then
    print("addLineup.." .. A1_184)
    RAC_setLineupIndex(A0_183, A1_184, L4_187)
    L3_186[A1_184] = 0
    return invokeTask(function()
      local L0_188, L1_189, L2_190, L3_191, L4_192, L5_193
      L0_188 = Fn_findNpc
      L1_189 = A1_184
      L0_188 = L0_188(L1_189)
      L1_189 = 1
      L2_190 = Fn_playMotionNpc
      L3_191 = npc_name
      L4_192 = "stay"
      L5_193 = false
      L2_190(L3_191, L4_192, L5_193)
      while true do
        L2_190 = RAC_getLineupIndex
        L3_191 = A0_183
        L4_192 = A1_184
        L2_190 = L2_190(L3_191, L4_192)
        if L2_190 ~= nil then
          L3_191 = _guest_finish
          L4_192 = A1_184
          L5_193 = RAC_invokeMoveCharaTask2
          L5_193 = L5_193(A1_184, {
            A2_185[L2_190]:getName()
          }, {arrivedLength = 0, runLength = -1})
          L3_191[L4_192] = L5_193
          while true do
            L3_191 = _guest_finish
            L4_192 = A1_184
            L3_191 = L3_191[L4_192]
            if L3_191 ~= nil then
              L3_191 = _guest_finish
              L4_192 = A1_184
              L3_191 = L3_191[L4_192]
              L4_192 = L3_191
              L3_191 = L3_191.isRunning
              L3_191 = L3_191(L4_192)
              if not L3_191 then
                L3_191 = _guest_finish
                L4_192 = A1_184
                L3_191 = L3_191[L4_192]
                L4_192 = L3_191
                L3_191 = L3_191.abort
                L3_191(L4_192)
                L3_191 = _guest_finish
                L4_192 = A1_184
                L3_191[L4_192] = nil
                break
              end
            end
            L3_191 = wait
            L3_191()
          end
          L4_192 = L0_188
          L3_191 = L0_188.reset
          L3_191(L4_192)
          if L2_190 == 1 then
            L3_191 = LINEUP_RETRY
            L4_192 = Fn_get_distance
            L5_193 = A2_185[L2_190]
            L5_193 = L5_193.getWorldPos
            L5_193 = L5_193(L5_193)
            L4_192 = L4_192(L5_193, _guests[A1_184]:getWorldPos())
            if not (L3_191 > L4_192) then
              L3_191 = A1_184
              L4_192 = A1_184
              L4_192 = L3_186[L4_192]
              L4_192 = L4_192 + 1
              L3_186[L3_191] = L4_192
              L3_191 = A1_184
              L3_191 = L3_186[L3_191]
              if L3_191 >= 10 then
                L3_191 = Fn_isInSightTarget
                L4_192 = _guests
                L5_193 = A1_184
                L4_192 = L4_192[L5_193]
                L3_191 = L3_191(L4_192)
                if L3_191 == false then
                  L4_192 = L0_188
                  L3_191 = L0_188.pauseMove
                  L5_193 = true
                  L3_191(L4_192, L5_193)
                  L3_191 = Fn_warpNpc
                  L4_192 = A1_184
                  L5_193 = A2_185[L2_190]
                  L3_191(L4_192, L5_193)
                  L3_191 = print
                  L4_192 = A1_184
                  L5_193 = "\229\190\169\229\184\176\227\129\167\227\129\141\227\129\170\227\129\132\227\129\174\227\129\167\227\128\129\227\131\175\227\131\188\227\131\151\227\129\149\227\129\155\227\130\139!!!!"
                  L4_192 = L4_192 .. L5_193
                  L3_191(L4_192)
                  L3_191 = A1_184
                  L3_186[L3_191] = 0
                  L4_192 = L0_188
                  L3_191 = L0_188.pauseMove
                  L5_193 = false
                  L3_191(L4_192, L5_193)
                end
              end
              else
                L3_191 = L2_190 - 1
                L4_192 = false
                while true do
                  L5_193 = RAC_findLineupIndex
                  L5_193 = L5_193(A0_183, L3_191)
                  if L5_193 ~= nil and _guests[A1_184] ~= nil then
                    if not L5_193 then
                      while true do
                        wait()
                        L3_191 = L3_191 - 1
                        L5_193 = RAC_findLineupIndex(A0_183, L3_191)
                        if L5_193 or L3_191 <= 0 then
                          L3_191 = L3_191 + 1
                          break
                        end
                      end
                      RAC_setLineupIndex(A0_183, A1_184, L3_191)
                      L3_186[A1_184] = 0
                      break
                    else
                      if LINEUP_RETRY < Fn_get_distance(A2_185[L2_190]:getWorldPos(), _guests[A1_184]:getWorldPos()) then
                        print(A1_184 .. "\229\190\169\229\184\176\228\184\173!!!!!!!!!")
                        L3_186[A1_184] = L3_186[A1_184] + 1
                        if L3_186[A1_184] >= 10 and Fn_isInSightTarget(_guests[A1_184]) == false then
                          L0_188:pauseMove(true)
                          Fn_warpNpc(A1_184, A2_185[L2_190])
                          print(A1_184 .. "\229\190\169\229\184\176\227\129\167\227\129\141\227\129\170\227\129\132\227\129\174\227\129\167\227\128\129\227\131\175\227\131\188\227\131\151\227\129\149\227\129\155\227\130\139!!!!")
                          L3_186[A1_184] = 0
                          L0_188:pauseMove(false)
                        end
                        break
                      end
                      if L4_192 == false then
                        Fn_turnNpc(A1_184, A2_185[L3_191], nil, true)
                        playNpcLineUpMotion(A1_184, L1_189, _line_up_ret_max)
                        L4_192 = true
                      end
                    end
                  end
                  waitSeconds(0.1)
                end
              end
              L1_189 = L1_189 + 1
            end
        end
      end
      L2_190 = print
      L3_191 = "LineupFirst.."
      L4_192 = A1_184
      L3_191 = L3_191 .. L4_192
      L2_190(L3_191)
      L2_190 = string
      L2_190 = L2_190.match
      L3_191 = A2_185[1]
      L4_192 = L3_191
      L3_191 = L3_191.getName
      L3_191 = L3_191(L4_192)
      L4_192 = "[^0-1]+"
      L2_190 = L2_190(L3_191, L4_192)
      L3_191 = Fn_turnNpc
      L4_192 = A1_184
      L5_193 = findGameObject2
      L5_193 = L5_193("Node", L2_190 .. string.format("%02d", 0))
      L3_191(L4_192, L5_193, nil, true)
      L3_191 = playNpcLineUpMotion
      L4_192 = A1_184
      L5_193 = L1_189
      L3_191(L4_192, L5_193, _line_up_ret_max)
      L3_191 = waitSeconds
      L4_192 = LINEUP_TOP_WAIT
      L3_191(L4_192)
      while true do
        L3_191 = _guests
        L4_192 = A1_184
        L3_191 = L3_191[L4_192]
        if L3_191 ~= nil then
          L3_191 = RAC_RaycastEyeSight
          L4_192 = _guests
          L5_193 = A1_184
          L4_192 = L4_192[L5_193]
          L5_193 = 200
          L3_191 = L3_191(L4_192, L5_193, 180, nil, 1.5)
          if L3_191 then
            L3_191 = Fn_isInSightTarget
            L4_192 = _guests
            L5_193 = A1_184
            L4_192 = L4_192[L5_193]
            L5_193 = 1
            L3_191 = L3_191(L4_192, L5_193)
          elseif not L3_191 then
            L3_191 = print
            L4_192 = "SightOut.."
            L5_193 = A1_184
            L4_192 = L4_192 .. L5_193
            L3_191(L4_192)
            break
          end
        end
        L3_191 = wait
        L3_191()
      end
    end)
  end
  return nil
end
L0_0 = "cubesensor2_goal_area_01_OnEnter"
_ENV[L0_0] = function(A0_194, A1_195)
  local L2_196
  L2_196 = A1_195.getName
  L2_196 = L2_196(A1_195)
  if _guests[L2_196] ~= nil then
    Fn_findNpc(L2_196):setStagger(false)
    if Fn_findNpc(L2_196):getActive() and _guest_goal[L2_196] == false and _guest_lineup_task[L2_196] == nil and _guest_grab[L2_196] == true then
      if Fn_findNpcPuppet(L2_196) then
        RAC_MultiNaviDel(L2_196)
      end
      _guest_goal[L2_196] = true
      if string.find(L2_196, "bonus_action_") ~= nil and string.find(L2_196, "GUSET") == nil then
      else
        _score = _score + 1
        Sound:playSEHandle("success")
      end
    end
  end
end
L0_0 = "createCubeSensor"
_ENV[L0_0] = function(A0_197, A1_198, A2_199, A3_200)
  local L4_201
  L4_201 = createGameObject2
  L4_201 = L4_201("MobSensor")
  L4_201:setName(A0_197)
  L4_201:setBox(A2_199)
  L4_201:setOnEnter(A0_197 .. "_OnEnter")
  L4_201:setOnLeave(A0_197 .. "_OnLeave")
  L4_201:try_init()
  L4_201:waitForReady()
  L4_201:try_start()
  if A3_200 ~= nil then
    A3_200:appendChild(L4_201)
  end
  return L4_201
end
L0_0 = "_is_get_mob_point"
_ENV[L0_0] = {}
L0_0 = "mob_sensor_OnEnter"
_ENV[L0_0] = function(A0_202, A1_203, A2_204)
  if _is_get_mob_point[A1_203] == nil then
    _is_get_mob_point[A1_203] = true
    _score = _score + 1
    Sound:playSEHandle("success")
  end
  if A2_204 ~= nil and A2_204:isGrabbed() then
    A2_204:setGrabReleaseForce(true)
  end
end
L0_0 = "mob_sensor_OnLeave"
_ENV[L0_0] = function(A0_205)
  local L1_206
end
L0_0 = "guestReleaseTask"
_ENV[L0_0] = function(A0_207)
  return invokeTask(function()
    local L0_208, L1_209, L2_210, L3_211, L4_212, L5_213
    L0_208 = 0
    L1_209 = Fn_findNpc
    L2_210 = A0_207
    L1_209 = L1_209(L2_210)
    L2_210 = Fn_getRandamNpcType
    L3_211 = A0_207
    L2_210 = L2_210(L3_211)
    L3_211 = string
    L3_211 = L3_211.find
    L4_212 = A0_207
    L5_213 = "bonus"
    L3_211 = L3_211(L4_212, L5_213)
    L3_211 = L3_211 ~= nil
    L4_212 = string
    L4_212 = L4_212.find
    L5_213 = A0_207
    L4_212 = L4_212(L5_213, "GUSET")
    L4_212 = L4_212 == nil
    L5_213 = print
    L5_213("guestReleaseTask.." .. A0_207 .. "(" .. L2_210 .. ")")
    L5_213 = string
    L5_213 = L5_213.find
    L5_213 = L5_213(L2_210, "man")
    if L5_213 ~= nil then
      L0_208 = 1
    end
    L5_213 = string
    L5_213 = L5_213.find
    L5_213 = L5_213(L2_210, "wom")
    if L5_213 ~= nil then
      L0_208 = 2
    end
    L5_213 = string
    L5_213 = L5_213.find
    L5_213 = L5_213(L2_210, "chi")
    if L5_213 ~= nil then
      L0_208 = 3
    end
    L5_213 = string
    L5_213 = L5_213.find
    L5_213 = L5_213(L2_210, "kid")
    if L5_213 ~= nil then
      L0_208 = 3
    end
    if L0_208 ~= 0 then
      L5_213 = Fn_setGrabNpc
      L5_213(A0_207, false, true)
      if L1_209 then
        L5_213 = Fn_loadNpcEventMotion
        L5_213(A0_207, _release_motion[L0_208])
        if L3_211 and L4_212 then
          L5_213 = _guest_goal
          L5_213 = L5_213[A0_207]
          if L5_213 == false then
            L5_213 = BONUS_TYPE_TBL
            L5_213 = L5_213.BALLOON
            if L2_210 == L5_213 then
              L5_213 = setUpBalloon
              L5_213 = L5_213(A0_207)
              _set_up_balloon_task = L5_213
            end
          end
        end
        L5_213 = math
        L5_213 = L5_213.random
        L5_213 = L5_213(1, RAC_GetTableLength(_release_motion[L0_208]))
        if L2_210 ~= BONUS_TYPE_TBL.BALLOON then
          Fn_playMotionNpc(A0_207, _release_motion[L0_208]["look_" .. string.format("%02d", L5_213)], true)
          Fn_playMotionNpc(A0_207, "stay", false)
        end
      end
      L5_213 = wait
      L5_213()
    end
    if L3_211 == false or L4_212 == false then
      L5_213 = releaseNpcToMob
      L5_213(A0_207)
    end
  end)
end
L0_0 = "setUpBalloon"
_ENV[L0_0] = function(A0_214)
  return invokeTask(function()
    local L0_215, L1_216
    L0_215 = {}
    L0_215.play = "man01_balloon_stay_00"
    L1_216 = Fn_loadNpcEventMotion
    L1_216(A0_214, L0_215)
    L1_216 = Balloon
    L1_216 = L1_216.create
    L1_216 = L1_216("_balloon_name_p")
    _balloon = L1_216
    L1_216 = _balloon
    L1_216 = L1_216.start
    L1_216(L1_216)
    L1_216 = Fn_findNpcPuppet
    L1_216 = L1_216(A0_214)
    while true do
      wait()
      if Fn_isInSightTarget(L1_216, 1) ~= false or not (Fn_getDistanceToPlayer(L1_216) > 10) then
      end
    end
    _balloon:attachJoint(L1_216, "loc_l_hand")
    Fn_playMotionNpc(A0_214, L0_215.play, false, {animBlendDuration = 0.3})
    while true do
      wait()
      if Fn_findNpc(A0_214) and Fn_findNpc(A0_214):isGrabbed() then
        RAC_MultiNaviDel(L1_216)
        if _balloon ~= nil then
          _balloon:release()
          break
        end
      end
    end
  end)
end
L0_0 = "setUpDelTrainNaviTask"
_ENV[L0_0] = function()
  invokeTask(function()
    local L0_217, L1_218, L2_219, L3_220
    L0_217 = 0
    L1_218 = 0
    L2_219 = true
    while true do
      L3_220 = DEL_TRAIN_NAVI_TIME
      L3_220 = L3_220 - TRAIN_NAVI_MIN_TIME
      if L1_218 <= L3_220 then
        if L2_219 then
          L3_220 = waitSeconds
          L3_220(TRAIN_NAVI_MIN_TIME)
          L2_219 = false
        end
        L3_220 = findGameObject2
        L3_220 = L3_220("Node", "locator2_navi_group_train")
        if L3_220 and Fn_getDistanceToPlayer(L3_220) < DEL_TRAIN_NAVI_DIST then
          RAC_MultiNaviDel("locator2_navi_group_train")
        end
        L0_217 = L0_217 + 1
        if L0_217 % FRAME_MAX == 0 then
          L1_218 = L1_218 + 1
        end
        wait()
      end
    end
    L3_220 = RAC_MultiNaviDel
    L3_220("locator2_navi_group_train")
  end)
end
L0_0 = "cubesensor2_npc_dis_OnEnter"
_ENV[L0_0] = function(A0_221, A1_222)
  local L2_223
  L2_223 = A1_222.getName
  L2_223 = L2_223(A1_222)
  if string.match(L2_223, "bonus_action_") ~= nil then
    if _bonus_npc_out[L2_223] == nil then
      _bonus_npc_out[L2_223] = 1
    else
      _bonus_npc_out[L2_223] = _bonus_npc_out[L2_223] + 1
      if _bonus_npc_out[L2_223] >= 1 and _guest_goal[L2_223] == false then
        RAC_MultiNaviAdd(Fn_findNpcPuppet(L2_223))
      end
    end
  end
end
L0_0 = "cubesensor2_npc_dis_OnLeave"
_ENV[L0_0] = function(A0_224, A1_225)
  local L2_226
  L2_226 = A1_225.getName
  L2_226 = L2_226(A1_225)
  if string.match(L2_226, "bonus_action_") ~= nil and _bonus_npc_out[L2_226] ~= nil then
    _bonus_npc_out[L2_226] = _bonus_npc_out[L2_226] - 1
    if _bonus_npc_out[L2_226] <= 0 then
      RAC_MultiNaviDel(L2_226)
    end
  end
end
L0_0 = "cubesensor2_npc_del_OnEnter"
_ENV[L0_0] = function(A0_227, A1_228)
  local L2_229
  L2_229 = A1_228.getName
  L2_229 = L2_229(A1_228)
  finalizeNpc(L2_229)
end
